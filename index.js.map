{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import Axios from \"axios\";\n\nexport async function getImagesByQuery(query, currentPage) {    \n    const params = {\n        key: '51701755-afeeef66c15ff24568cee0a11',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: currentPage,\n    }\n    const axios = Axios.create({\n        baseURL: 'https://pixabay.com/api/',\n        params: params,\n    })    \n    const res = await axios.get();\n    return res.data;\n}\n\n\n// const api = axios.create({\n//     baseURL: 'https://pixabay.com/api/',\n//     params: {\n//         key: '51701755-afeeef66c15ff24568cee0a11',\n//         image_type: 'photo',\n//         orientation: 'horizontal',\n//         safesearch: true,\n//         per_page: 15,\n//     },\n// });\n\n// export async function getImagesByQuery(query, currentPage) {\n//     const res = await api.get('', { params: { q: query, page: currentPage } });\n//     return res.data;\n// }\n","export const refs = {\n    formELem: document.querySelector('.form'),\n    imagesList: document.querySelector('.gallery'),\n    loaderElem: document.querySelector('.loader'),\n    loadMoreElem: document.querySelector('.js-load-more-btn'),    \n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { refs } from \"./refs\";\n\nexport const lightbox = new SimpleLightbox('.img-card a');\nexport function imageTemplate ({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) {\n    return `<li class=\"img-card\">\n    <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\">\n    </a>\n    <ul class=\"card-text\">\n    <li class=\"card-content\"><p class=\"card-content-title\">Likes</p><p>${likes}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Views</p><p>${views}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Comments</p><p>${comments}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Downloads</p><p>${downloads}</p></li>    \n    </ul>\n    </li>`\n}\nexport function renderImages(imgArr) {\n  const markup = imgArr.map(imageTemplate).join('');\n  refs.imagesList.innerHTML = markup;\n  lightbox.refresh();  \n}\nexport function renderMoreImages(imgArr) {\n    const markup = imgArr.map(imageTemplate).join('');\n    refs.imagesList.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\nexport function clearGallery() {\n    refs.imagesList.innerHTML = '';\n}\n\nexport function showLoadInfo() {\n    refs.loaderElem.classList.remove('visually-hidden');\n}\nexport function hideLoadInfo() {\n    refs.loaderElem.classList.add('visually-hidden');\n}\n \nexport function showLoadMoreButton() {\n    refs.loadMoreElem.classList.remove('visually-hidden');\n}\nexport function hideLoadMoreButton() {\n    refs.loadMoreElem.classList.add('visually-hidden');\n}","import { getImagesByQuery } from './js/pixabay-api';\nimport { refs } from './js/refs';\nimport { renderImages, clearGallery, showLoadInfo, hideLoadInfo,showLoadMoreButton, hideLoadMoreButton, renderMoreImages } from './js/render-functions'; \nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nrefs.formELem.addEventListener('submit', handleFormElem);\nrefs.loadMoreElem.addEventListener('click', handleLoadMore);\n\nlet currentPage;\nlet maxPage;\nlet query;\n\nfunction checkLoadMoreButton() {\n    if (currentPage < maxPage) {\n        showLoadMoreButton();\n    } else {\n        hideLoadMoreButton();\n        iziToast.info({\n            message: 'We are sorry, but you have reached the end of search results.',\n        });\n    }\n}\n\nasync function handleFormElem(e) {\n    e.preventDefault();\n    clearGallery();\n    showLoadInfo();\n    \n    currentPage = 1;\n    query = e.target.elements.searchText.value.trim();\n    if (!query) {\n        iziToast.info({\n            message: 'Please enter search words',\n            position: 'topRight',\n        })\n        \n        return;\n    }\n    try {\n        const data = await getImagesByQuery(query, currentPage);\n        maxPage = Math.ceil(data.totalHits / 15);\n        const imgArr = data.hits;\n        hideLoadInfo();        \n        if (imgArr.length === 0) {\n            iziToast.error({\n                title: 'Nothing found!',\n                message: `Sorry, there are no images matching your search \"${query}\". Please try again!`,\n                position: 'topRight',\n            })\n            hideLoadMoreButton();\n        } else {\n            renderImages(imgArr);\n            e.target.reset();\n            checkLoadMoreButton();\n        }\n        \n    }\n    catch {           \n        iziToast.error({                \n            message: `Sorry, we have connection problems. Please try again!`,\n            position: 'topRight',\n        });\n    } finally {     \n        hideLoadInfo();\n    }\n}\n\nasync function handleLoadMore() {\n    try {        \n        showLoadInfo();\n        currentPage += 1;\n        const data = await getImagesByQuery(query, currentPage);\n        const imgArr = data.hits;\n        renderMoreImages(imgArr);\n        checkLoadMoreButton();\n        const rect = document.querySelector('.img-card').getBoundingClientRect();            \n            window.scrollBy({ \n                top: rect.height * 2, \n                behavior: 'smooth' \n              });                 \n    } catch {\n        currentPage -= 1;\n        \n        iziToast.info({\n            message: 'Sorry, we have connection problems!'\n        });\n    } finally {\n        hideLoadInfo();\n        refs.loadMoreElem.blur();\n    }\n}\n\n\n\n"],"names":["getImagesByQuery","query","currentPage","params","Axios","refs","lightbox","SimpleLightbox","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImages","imgArr","markup","renderMoreImages","clearGallery","showLoadInfo","hideLoadInfo","showLoadMoreButton","hideLoadMoreButton","handleFormElem","handleLoadMore","maxPage","checkLoadMoreButton","iziToast","e","data","rect"],"mappings":"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"}