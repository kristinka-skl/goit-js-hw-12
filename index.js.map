{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import Axios from \"axios\";\n\nexport async function getImagesByQuery(query, currentPage) {    \n    const params = {\n        key: '51701755-afeeef66c15ff24568cee0a11',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: currentPage,\n    }\n    const axios = Axios.create({\n        baseURL: 'https://pixabay.com/api/',\n        params: params,\n    })    \n    const res = await axios.get();\n    return res.data;\n}","export const refs = {\n    formELem: document.querySelector('.form'),\n    imagesList: document.querySelector('.gallery'),\n    loaderElem: document.querySelector('.loader'),\n    loadMoreElem: document.querySelector('.js-load-more-btn'),\n    imgCard: document.querySelector('.img-card'),\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { refs } from \"./refs\";\n\nexport const lightbox = new SimpleLightbox('.img-card a');\nexport function imageTemplate ({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) {\n    return `<li class=\"img-card\">\n    <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\">\n    </a>\n    <ul class=\"card-text\">\n    <li class=\"card-content\"><p class=\"card-content-title\">Likes</p><p>${likes}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Views</p><p>${views}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Comments</p><p>${comments}</p></li>\n    <li class=\"card-content\"><p class=\"card-content-title\">Downloads</p><p>${downloads}</p></li>    \n    </ul>\n    </li>`\n}\nexport function renderImages(imgArr) {\n  const markup = imgArr.map(imageTemplate).join('');\n  refs.imagesList.innerHTML = markup;\n  lightbox.refresh();  \n}\nexport function renderMoreImages(imgArr) {\n    const markup = imgArr.map(imageTemplate).join('');\n    refs.imagesList.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\nexport function clearGallery() {\n    refs.imagesList.innerHTML = '';\n}\n\nexport function showLoadInfo() {\n    refs.loaderElem.classList.remove('visually-hidden');\n}\nexport function hideLoadInfo() {\n    refs.loaderElem.classList.add('visually-hidden');\n}\n \nexport function showLoadMoreButton() {\n    refs.loadMoreElem.classList.remove('visually-hidden');\n}\nexport function hideLoadMoreButton() {\n    refs.loadMoreElem.classList.add('visually-hidden');\n}","import { getImagesByQuery } from './js/pixabay-api';\nimport { refs } from './js/refs';\nimport { renderImages, clearGallery, showLoadInfo, hideLoadInfo,showLoadMoreButton, hideLoadMoreButton, renderMoreImages } from './js/render-functions'; \nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nrefs.formELem.addEventListener('submit', handleFormElem);\nlet currentPage;\nlet maxPage;\nlet query;\n\nasync function handleFormElem(e) {\n    e.preventDefault();\n    clearGallery();\n    showLoadInfo();\n    hideLoadMoreButton();\n    currentPage = 1;\n    query = e.target.elements.searchText.value.trim();\n    if (query === '') {\n        iziToast.info({\n            message: 'Please enter search words',\n            position: 'topRight',\n        })\n        hideLoadInfo();\n        return;\n    }\n    const data = await getImagesByQuery(query, currentPage);\n    try {\n        maxPage = Math.ceil(data.totalHits / 15);\n        const imgArr = data.hits;\n        hideLoadInfo();        \n        if (imgArr.length === 0) {\n            iziToast.error({\n                title: 'Nothing found!',\n                message: `Sorry, there are no images matching your search \"${query}\". Please try again!`,\n                position: 'topRight',\n            })\n            hideLoadMoreButton();\n        } else {\n            renderImages(imgArr);\n            e.target.reset();\n        }\n        if (currentPage < maxPage) {\n            showLoadMoreButton();\n        } else if (currentPage === maxPage) {                \n            hideLoadMoreButton();\n            iziToast.info({\n                message: 'We are sorry, but you have reached the end of search results.',\n            })\n        }\n    }\n    catch {           \n        iziToast.error({                \n            message: `Sorry, we have connection problems. Please try again!`,\n            position: 'topRight',\n        });\n    }     \n    hideLoadInfo();\n}\n\nrefs.loadMoreElem.addEventListener('click', handleLoadMore);\nasync function handleLoadMore() {\n    try {\n        hideLoadMoreButton();\n        if (currentPage < maxPage) {            \n            currentPage += 1;\n            showLoadInfo();            \n            const data = await getImagesByQuery(query, currentPage);\n            const imgArr = data.hits;\n            renderMoreImages(imgArr);\n            showLoadMoreButton();            \n            hideLoadInfo();\n            const rect = document.querySelector('.img-card').getBoundingClientRect();            \n            window.scrollBy({ \n                top: rect.height * 2, \n                behavior: 'smooth' \n              });           \n            if (currentPage === maxPage) {                \n                hideLoadMoreButton();\n                iziToast.info({\n                    message: 'We are sorry, but you have reached the end of search results.',\n                })\n            }\n        }\n    } catch {\n        currentPage -= 1;\n        showLoadMoreButton();\n        iziToast.info({\n            message: 'Sorry, we have connection problems!'\n        });\n    }\n    hideLoadInfo();\n    refs.loadMoreElem.blur();\n}\n\n\n\n"],"names":["getImagesByQuery","query","currentPage","params","Axios","refs","lightbox","SimpleLightbox","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImages","imgArr","markup","renderMoreImages","clearGallery","showLoadInfo","hideLoadInfo","showLoadMoreButton","hideLoadMoreButton","handleFormElem","maxPage","e","iziToast","data","handleLoadMore","rect"],"mappings":"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"}